p <- p + geom_polygon(data=usa, aes(x=long, y=lat, group = group),colour="white") +
scale_fill_continuous(low = "thistle2", high = "darkred", guide="colorbar")
p <-  geom_map(map = usa,
aes(map_id = region))
return(p)
})
output$Trends <- renderPlot({
})
}
shinyApp(ui, server)
View(maxmin.2014)
typeof(max.2016$Mortality.Rate)
max(max.2016$Mortality.Rate)
deaths.2010 %>% group_by(City) %>% select(Year.x, City, STNAME, Mortality.Rate)
#2010
max.2010 <-
View(deaths.2010 %>% group_by(City) %>% select(Year.x, City, STNAME, Mortality.Rate) )
View(deaths.2010)
#2010
max.2010 <-
View(deaths.2010 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
select(Year.x, City, STNAME, Mortality.Rate) )
#2010
max.2010 <-
View(deaths.2010 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) )
#2010
max.2010 <-
View(deaths.2010 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
filter(Mortality.Rate == max(Mortality.Rate)))
#2010
max.2010 <-
View(deaths.2010 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == max(Mortality.Rate)))
min.2010 <- deaths.2010 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == min(Mortality.Rate))
View(min.2010)
maxmin.2010 <- full_join(max.2010, min.2010)
maxmin.2010 <- full_join(max.2010, min.2010)
maxmin.2010 <- full_join(max.2010, min.2010)
maxmin.2010 <- full_join(max.2010, min.2010)
library("dplyr")
library("maps")
library("tidyr")
library("sp")
library("shiny")
library("ggplot2")
maxmin.2010 <- full_join(max.2010, min.2010)
#2010
max.2010 <- deaths.2010 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == max(Mortality.Rate))
min.2010 <- deaths.2010 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == min(Mortality.Rate))
maxmin.2010 <- full_join(max.2010, min.2010)
View(maxmin.2010)
# 2011
max.2011 <- deaths.2011 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == max(Mortality.Rate))
View(max.2011)
# 2011
max.2011 <- deaths.2011 %>%
group_by(City) %>%
filter(WEEK == 2) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == max(Mortality.Rate))
min.2011 <- deaths.2011 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == max(Mortality.Rate))
View(min.2011)
min.2011 <- deaths.2011 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == min(Mortality.Rate))
View(min.2011)
maxmin.2011 <- full_join(max.2011, min.2011)
View(maxmin.2011)
# 2012
max.2012 <- deaths.2012 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == max(Mortality.Rate))
min.2012 <- deaths.2012 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == min(Mortality.Rate))
maxmin.2012 <- full_join(max.2012, min.2012)
View(maxmin.2012)
maxmin.2012 <- full_join(max.2012, min.2012)
# 2013
max.2013 <- deaths.2010 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == max(Mortality.Rate))
# 2013
max.2013 <- deaths.2013 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == max(Mortality.Rate))
min.2013 <- deaths.2013 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == max(Mortality.Rate))
maxmin.2013 <- full_join(max.2013, min.2013)
View(maxmin.2013)
min.2013 <- deaths.2013 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == min(Mortality.Rate))
View(maxmin.2011)
# 2014
max.2014 <- deaths.2014 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == max(Mortality.Rate))
min.2014 <- deaths.2014 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == max(Mortality.Rate))
maxmin.2014 <- full_join(max.2014, min.2014)
View(maxmin.2014)
min.2014 <- deaths.2014 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == min(Mortality.Rate))
maxmin.2014 <- full_join(max.2014, min.2014)
View(maxmin.2014)
View(maxmin.2013)
min.2013 <- deaths.2013 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == min(Mortality.Rate))
View(min.2013)
maxmin.2013 <- full_join(max.2013, min.2013)
maxmin.2014 <- full_join(max.2014, min.2014)
View(maxmin.2014)
# 2015
max.2015 <- deaths.2015 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == min(Mortality.Rate))
View(max.2015)
min.2015 <- deaths.2015 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == min(Mortality.Rate))
View(min.2015)
# 2015
max.2015 <- deaths.2015 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == max(Mortality.Rate))
View(max.2015)
maxmin.2015 <- full_join(max.2015, min.2015)
# 2016
max.2016 <- deaths.2016 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == max(Mortality.Rate))
# 2016
max.2016 <- deaths.2016 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == max(Mortality.Rate))
View(max.2016)
min.2016 <- deaths.2016 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == min(Mortality.Rate))
View(min.2016)
min.2016 <- deaths.2016 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(City != "Des Moine", Mortality.Rate == min(Mortality.Rate))
View(min.2016)
min.2016 <- deaths.2016 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(City != "Des Moines", Mortality.Rate == min(Mortality.Rate))
View(min.2016)
filter(Mortality.Rate == min(Mortality.Rate))
min.2016 <- deaths.2016 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>% filter(Mortality.Rate != 0)
filter(Mortality.Rate == min(Mortality.Rate))
min.2016 <- deaths.2016 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>% filter(Mortality.Rate != 0) %>%
filter(Mortality.Rate == min(Mortality.Rate))
View(min.2016)
View(min.2015)
min.2015 <- deaths.2015 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>% filter(Mortality.Rate != 0) %>%
filter(Mortality.Rate == min(Mortality.Rate))
View(min.2015)
maxmin.2015 <- full_join(max.2015, min.2015)
# 2016
max.2016 <- deaths.2016 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == max(Mortality.Rate))
min.2016 <- deaths.2016 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>% filter(Mortality.Rate != 0) %>%
filter(Mortality.Rate == min(Mortality.Rate))
maxmin.2016 <- full_join(max.2016, min.2016)
View(maxmin.2016)
# 2016
max.2016 <- deaths.2016 %>%
group_by(City) %>%
filter(WEEK == 3) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == max(Mortality.Rate))
library("dplyr")
library("maps")
library("tidyr")
library("sp")
library("shiny")
library("ggplot2")
# 2016
max.2016 <- deaths.2016 %>%
group_by(City) %>%
filter(WEEK == 3) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == max(Mortality.Rate))
View(max.2016)
# 2016
max.2016 <- deaths.2016 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>%
filter(Mortality.Rate == max(Mortality.Rate))
View(max.2016)
View(maxmin.2011)
min.2016 <- deaths.2016 %>%
group_by(City) %>%
filter(WEEK == 1)
library("dplyr")
library("maps")
library("tidyr")
library("sp")
library("shiny")
library("ggplot2")
max.2012 <- deaths.2012 %>%
group_by(City) %>%
filter(WEEK == 1)
max.2012
View(max.2012)
View(maxmin.2010)
View(maxmin.2011)
GetAgeDeaths <- function(year){
g <- age.group %>% filter(Year == year) %>% group_by(age.group) %>%
summarize(sum = sum(agegroup.deaths, na.rm = TRUE))
}
ages.2010 <- GetAgeDeaths(2010)
View(ages.2010)
AgeGroupDeaths <- function(ages){
t <- age.group %>% filter(age.group == ages) %>% group_by(Year) %>%
summarize(sum = sum(agegroup.deaths, na.rm = TRUE))
}
frist.ages <- AgeGroupDeaths('<1')
View(frist.ages)
YearlyDeaths <- function(year){
deaths <- pneumonia.deaths %>% filter(Year.x == 2010) %>%
group_by(City) %>% mutate("Mortality.Rate" =
sum(All.Deaths) / ESTIMATE * 100)
table <- deaths %>% group_by(City) %>% filter(Mortality.Rate == max(Mortality.Rate,
na.rm = TRUE))
return(table)
}
YearlyDeaths(2010)
deaths.2010 <- YearlyDeaths(2010)
View(deaths.2010)
View(deaths.2010)
YearlyDeaths <- function(year){
deaths <- pneumonia.deaths %>% filter(Year.x == 2010) %>%
group_by(City) %>% mutate("Mortality.Rate" =
sum(All.Deaths) / ESTIMATE * 100)
table <- deaths %>% group_by(City) %>% filter(Mortality.Rate == max(Mortality.Rate,
na.rm = TRUE))
min <- table %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>% filter(Mortality.Rate != 0) %>%
filter(Mortality.Rate == min(Mortality.Rate))
max <- deaths.2016 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>% filter(Mortality.Rate != 0) %>%
filter(Mortality.Rate == max(Mortality.Rate))
min.max <- full_join(min, max)
return(min.max)
}
deaths.2010 <- YearlyDeaths(2010)
library("dplyr")
library("maps")
library("tidyr")
library("sp")
library("shiny")
library("ggplot2")
YearlyDeaths <- function(year){
deaths <- pneumonia.deaths %>% filter(Year.x == 2010) %>%
group_by(City) %>% mutate("Mortality.Rate" =
sum(All.Deaths) / ESTIMATE * 100)
table <- deaths %>% group_by(City) %>% filter(Mortality.Rate == max(Mortality.Rate,
na.rm = TRUE))
min <- table %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>% filter(Mortality.Rate != 0) %>%
filter(Mortality.Rate == min(Mortality.Rate))
max <- deaths.2016 %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>% filter(Mortality.Rate != 0) %>%
filter(Mortality.Rate == max(Mortality.Rate))
min.max <- full_join(min, max)
return(min.max)
}
deaths.2010 <- YearlyDeaths(2010)
View(deaths.2010)
deaths.2010 <- YearlyDeaths(2016)
View(deaths.2010)
YearlyDeaths <- function(year){
deaths <- pneumonia.deaths %>% filter(Year.x == 2010) %>%
group_by(City) %>% mutate("Mortality.Rate" =
sum(All.Deaths) / ESTIMATE * 100)
table <- deaths %>% group_by(City) %>% filter(Mortality.Rate == max(Mortality.Rate,
na.rm = TRUE))
min <- table %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>% filter(Mortality.Rate != 0) %>%
filter(Mortality.Rate == min(Mortality.Rate))
max <- table %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>% filter(Mortality.Rate != 0) %>%
filter(Mortality.Rate == max(Mortality.Rate))
min.max <- full_join(min, max)
return(min.max)
}
deaths.2010 <- YearlyDeaths(2016)
View(deaths.2010)
deaths.2010 <- YearlyDeaths(2010)
View(deaths.2010)
deaths.2011 <- YearlyDeaths(2011)
View(deaths.2011)
View(deaths.2010)
YearlyDeaths <- function(year){
deaths <- pneumonia.deaths %>% filter(Year.x == year) %>%
group_by(City) %>% mutate("Mortality.Rate" =
sum(All.Deaths) / ESTIMATE * 100)
table <- deaths %>% group_by(City) %>% filter(Mortality.Rate == max(Mortality.Rate,
na.rm = TRUE))
min <- table %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>% filter(Mortality.Rate != 0) %>%
filter(Mortality.Rate == min(Mortality.Rate))
max <- table %>%
group_by(City) %>%
filter(WEEK == 1) %>%
na.omit() %>%
select(Year.x, City, STNAME, Mortality.Rate) %>%
ungroup(City) %>% filter(Mortality.Rate != 0) %>%
filter(Mortality.Rate == max(Mortality.Rate))
min.max <- full_join(min, max)
return(min.max)
}
deaths.2011 <- YearlyDeaths(2011)
View(deaths.2011)
deaths.2010 <- YearlyDeaths(2010)
View(deaths.2010)
deaths.2010 <- YearlyDeaths(2016)
View(deaths.2016)
deaths.2010 <- YearlyDeaths(2016)
View(deaths.2010)
runApp()
runApp()
